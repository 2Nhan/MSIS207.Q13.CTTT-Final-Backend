openapi: 3.0.1
info:
  title: CRM API Documentation
  version: "1.0.0"
  description: |
    Complete API specification for the Basic CRM system.
    
    This API provides comprehensive customer relationship management features including:
    - **Authentication & User Management**: Secure JWT-based authentication and user profiles
    - **Product Management**: Complete product catalog with inventory, pricing, and CSV import
    - **Lead Management**: Sales pipeline with stages, activity tracking, and lead conversion
    - **Quotation System**: Create and send professional quotations to leads
    - **Order Management**: Convert quotations to orders and track fulfillment
    - **Customer Management**: View converted customers and their order history

  contact:
    name: API Support
    email: support@example.com
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html

servers:
  - url: http://13.251.45.52:8088/crm
    description: Production server
  - url: http://localhost:8088/crm
    description: Development server

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT Bearer token authentication. 
        After logging in, include the access token in the Authorization header:
        `Authorization: Bearer {accessToken}`

  schemas:
    # ==================== COMMON SCHEMAS ====================
    
    MyApiResponse:
      type: object
      description: |
        Standard response wrapper used by all API endpoints.
        Provides consistent structure with status code, message, optional data payload, 
        error details, and pagination metadata.
      properties:
        code:
          type: integer
          description: "HTTP-like status code (200, 201, 400, 404, 500, etc.)"
          example: 200
        message:
          type: string
          description: "Human-readable status message"
          example: "Process succeed"
        data:
          type: object
          description: "Response payload - structure varies by endpoint"
          nullable: true
        error:
          description: "Error details if request failed"
          oneOf:
            - type: object
              description: "Single error object"
            - type: array
              description: "Array of validation errors"
              items:
                type: object
          nullable: true
        pagination:
          $ref: '#/components/schemas/PageInfo'
          nullable: true

    PageInfo:
      type: object
      description: "Pagination metadata for list responses"
      properties:
        hasPre:
          type: boolean
          description: "Indicates if there is a previous page available"
          example: false
        hasNext:
          type: boolean
          description: "Indicates if there is a next page available"
          example: true
        pageNumber:
          type: integer
          description: "Current page number (1-indexed)"
          example: 1
          minimum: 1
        totalPages:
          type: integer
          description: "Total number of pages"
          example: 10
          minimum: 0
    
    ErrorDetail:
      type: object
      description: "Detailed error information"
      properties:
        code:
          type: integer
          description: "Application-specific error code"
          example: 1007
        message:
          type: string
          description: "Error message"
          example: "Product not found"
        errorField:
          type: string
          description: "Field name that caused the validation error (for validation errors)"
          example: "sku"
          nullable: true

    # ==================== AUTHENTICATION & USER SCHEMAS ====================
    
    LoginRequest:
      type: object
      required:
        - username
        - password
      description: "Login credentials"
      properties:
        username:
          type: string
          description: "User's username"
          example: "johndoe"
          minLength: 1
        password:
          type: string
          description: "User's password"
          format: password
          example: "password123"
          minLength: 1

    LoginResponse:
      type: object
      description: "Successful login response with JWT tokens"
      properties:
        accessToken:
          type: string
          description: "JWT access token for API authentication"
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        refreshToken:
          type: string
          description: "JWT refresh token for obtaining new access tokens"
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        fullName:
          type: string
          description: "User's full name"
          example: "John Doe"
        avatarUrl:
          type: string
          description: "URL to user's avatar image"
          example: "https://res.cloudinary.com/demo/image/upload/avatar.jpg"
          nullable: true

    RefreshRequest:
      type: object
      required:
        - refreshToken
      description: "Request to refresh access token"
      properties:
        refreshToken:
          type: string
          description: "Valid refresh token obtained from login"
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

    RefreshResponse:
      type: object
      description: "New access token after refresh"
      properties:
        accessToken:
          type: string
          description: "New JWT access token"
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

    UserCreationRequest:
      type: object
      required:
        - username
        - password
        - firstName
        - lastName
        - email
        - phoneNumber
      description: "User registration request"
      properties:
        username:
          type: string
          description: "Unique username (8-100 characters)"
          example: "johndoe123"
          minLength: 8
          maxLength: 100
        password:
          type: string
          description: "Password (minimum 8 characters)"
          format: password
          example: "SecurePass123!"
          minLength: 8
        firstName:
          type: string
          description: "User's first name"
          example: "John"
        lastName:
          type: string
          description: "User's last name"
          example: "Doe"
        email:
          type: string
          format: email
          description: "Valid email address (must be unique)"
          example: "john.doe@example.com"
        phoneNumber:
          type: string
          description: "10-digit phone number (must be unique)"
          pattern: '^[0-9]{10}$'
          example: "0123456789"
        address:
          type: string
          description: "User's address"
          example: "123 Main Street, City"
          nullable: true

    UserUpdateRequest:
      type: object
      description: "Update user profile (all fields optional)"
      properties:
        firstName:
          type: string
          description: "Updated first name"
          example: "John"
        lastName:
          type: string
          description: "Updated last name"
          example: "Doe"
        email:
          type: string
          format: email
          description: "Updated email address"
          example: "john.doe@example.com"
        phoneNumber:
          type: string
          description: "Updated 10-digit phone number"
          pattern: '^[0-9]{10}$'
          example: "0987654321"
        address:
          type: string
          description: "Updated address"
          example: "456 New Street, City"

    UserResponse:
      type: object
      description: "User profile information"
      properties:
        id:
          type: string
          format: uuid
          description: "Unique user identifier"
          example: "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
        username:
          type: string
          description: "Username"
          example: "johndoe123"
        firstName:
          type: string
          description: "First name"
          example: "John"
        lastName:
          type: string
          description: "Last name"
          example: "Doe"
        email:
          type: string
          format: email
          description: "Email address"
          example: "john.doe@example.com"
        phoneNumber:
          type: string
          description: "Phone number"
          example: "0123456789"
        address:
          type: string
          description: "Address"
          example: "123 Main Street"
          nullable: true
        avatarUrl:
          type: string
          description: "Avatar image URL"
          example: "https://res.cloudinary.com/demo/image/upload/avatar.jpg"
          nullable: true
        createdAt:
          type: string
          format: date-time
          description: "Account creation timestamp"
          example: "2024-01-01T10:00:00"
        updatedAt:
          type: string
          format: date-time
          description: "Last update timestamp"
          example: "2024-01-15T14:30:00"

    ImageResponse:
      type: object
      description: "Uploaded image URL response"
      properties:
        imageUrl:
          type: string
          description: "Public URL of uploaded image stored on Cloudinary"
          example: "https://res.cloudinary.com/demo/image/upload/v1234567890/image.jpg"

    # ==================== PRODUCT SCHEMAS ====================
    
    ProductCreationRequest:
      type: object
      required:
        - sku
        - name
        - category
        - status
        - price
      description: |
        Product creation request. Supports multipart/form-data for optional image upload.
        Required fields: SKU, name, category, status, and price.
      properties:
        sku:
          type: string
          description: "Unique Stock Keeping Unit identifier"
          example: "PRD-001"
        name:
          type: string
          description: "Product name"
          example: "Vitamin C 500mg"
        description:
          type: string
          description: "Detailed product description"
          example: "Vitamin C supplement that helps boost immune system"
          nullable: true
        subtitle:
          type: string
          description: "Product tagline or subtitle"
          example: "Boost your immunity naturally"
          nullable: true
        brand:
          type: string
          description: "Brand or manufacturer name"
          example: "Bidiphar"
          nullable: true
        category:
          type: string
          description: "Product category"
          example: "Supplement"
        quantity:
          type: integer
          description: "Available stock quantity"
          example: 100
          minimum: 0
          nullable: true
        status:
          type: string
          description: "Product status"
          enum: [ Active, Inactive, Preorder ]
          example: "Active"
        price:
          type: number
          format: double
          description: "Unit selling price (VND)"
          example: 59000
          minimum: 0
        discount:
          type: number
          format: double
          description: "Discount amount (percentage or fixed amount based on discountType)"
          example: 5.0
          minimum: 0
          nullable: true
        discountType:
          type: string
          description: "Type of discount applied"
          enum: [ PERCENT, AMOUNT, NONE ]
          example: "PERCENT"
          nullable: true
        tag:
          type: string
          description: "Comma-separated tags for search and filtering"
          example: "immune,health,vitamin"
          nullable: true
        image:
          type: string
          format: binary
          description: "Product image file (JPG, PNG, WEBP, max 1MB)"
          nullable: true

    ProductUpdateRequest:
      type: object
      description: |
        Update product information (partial update supported - only send fields to update).
        Supports multipart/form-data for optional image update.
      properties:
        sku:
          type: string
          description: "Updated SKU"
          example: "PRD-001-V2"
        name:
          type: string
          description: "Updated product name"
          example: "Vitamin C 1000mg"
        description:
          type: string
          description: "Updated description"
        subtitle:
          type: string
          description: "Updated subtitle"
        brand:
          type: string
          description: "Updated brand"
        category:
          type: string
          description: "Updated category"
        quantity:
          type: integer
          description: "Updated quantity"
          minimum: 0
        status:
          type: string
          description: "Updated status"
          enum: [ Active, Inactive, Preorder ]
        price:
          type: number
          format: double
          description: "Updated price"
          minimum: 0
        discount:
          type: number
          format: double
          description: "Updated discount"
          minimum: 0
        discountType:
          type: string
          enum: [ PERCENT, AMOUNT, NONE ]
        tag:
          type: string
          description: "Updated tags"
        image:
          type: string
          format: binary
          description: "New product image"

    ProductResponse:
      type: object
      description: "Product information response"
      properties:
        productId:
          type: string
          format: uuid
          description: "Unique product identifier"
          example: "a5b7d3c1-9d2b-4ac0-b03b-9e47c3e8e21a"
        sku:
          type: string
          description: "Stock Keeping Unit"
          example: "PRD-001"
        productName:
          type: string
          description: "Product name"
          example: "Vitamin C 500mg"
        description:
          type: string
          description: "Product description"
          example: "Vitamin C supplement that helps boost immune system"
          nullable: true
        productSubtitle:
          type: string
          description: "Product subtitle"
          example: "Boost your immunity naturally"
          nullable: true
        productBrand:
          type: string
          description: "Brand name"
          example: "Bidiphar"
          nullable: true
        productCategory:
          type: string
          description: "Category"
          example: "Supplement"
        quantity:
          type: integer
          description: "Stock quantity"
          example: 100
          nullable: true
        status:
          type: string
          description: "Product status"
          example: "Active"
          enum: [ Active, Inactive, Preorder ]
        purchaseUnitPrice:
          type: number
          format: double
          description: "Unit price (VND)"
          example: 59000
        discount:
          type: number
          format: double
          description: "Discount amount"
          example: 5.0
          nullable: true
        discountType:
          type: string
          description: "Discount type"
          example: "PERCENT"
          enum: [ PERCENT, AMOUNT, NONE ]
          nullable: true
        tag:
          type: string
          description: "Product tags (comma-separated)"
          example: "immune,health,vitamin"
          nullable: true
        imageUrl:
          type: string
          description: "Product image URL"
          example: "https://res.cloudinary.com/demo/image/upload/product.jpg"
          nullable: true

    MatchingRequest:
      type: object
      description: |
        CSV column mapping configuration for import operations.
        Maps CSV column headers to corresponding entity fields.
      additionalProperties:
        type: string
      example:
        sku_field: "sku"
        name_field: "name"
        price_field: "price"
        category_field: "category"

    ImportResultResponse:
      type: object
      description: "CSV import result with successful and failed items"
      properties:
        validList:
          type: array
          description: "Successfully imported items"
          items:
            type: object
        invalidList:
          type: array
          description: "Failed items with error details"
          items:
            type: object

    # ==================== STAGE SCHEMAS ====================
    
    StageCreationRequest:
      type: object
      required:
        - name
        - order
      description: "Create a new pipeline stage"
      properties:
        name:
          type: string
          description: "Unique stage name"
          example: "Qualified"
        order:
          type: integer
          description: "Display order in pipeline (lower numbers appear first)"
          example: 2
          minimum: 1

    StageUpdateRequest:
      type: object
      description: "Update stage properties"
      properties:
        name:
          type: string
          description: "Updated stage name"
          example: "Highly Qualified"
        order:
          type: integer
          description: "Updated display order"
          example: 3
          minimum: 1

    StageResponse:
      type: object
      description: "Stage information"
      properties:
        id:
          type: string
          format: uuid
          example: "stage-uuid-123"
        name:
          type: string
          example: "New"
        color:
          type: string
          description: "Stage color (hex code)"
          example: "#4CAF50"

    # ==================== LEAD SCHEMAS ====================
    
    LeadCreationRequest:
      type: object
      required:
        - fullName
        - email
        - phoneNumber
      description: "Create a new lead in the pipeline"
      properties:
        fullName:
          type: string
          description: "Lead's full name"
          example: "Jane Smith"
        dateOfBirth:
          type: string
          format: date
          description: "Date of birth"
          example: "1990-05-15"
          nullable: true
        email:
          type: string
          format: email
          description: "Email address"
          example: "jane.smith@company.com"
        phoneNumber:
          type: string
          description: "10-digit phone number"
          pattern: '^[0-9]{10}$'
          example: "0987654321"
        company:
          type: string
          description: "Company name"
          example: "ABC Corporation"
          nullable: true
        rating:
          type: integer
          description: "Lead quality rating (1-5)"
          minimum: 1
          maximum: 5
          example: 4
          nullable: true
        expectedRevenue:
          type: number
          format: double
          description: "Expected revenue from this lead (VND)"
          example: 5000000
          minimum: 0
          nullable: true
        note:
          type: string
          description: "Additional notes about the lead"
          example: "Interested in vitamin products for company purchase"
          nullable: true
        source:
          type: string
          description: "Lead source (e.g., Website, Referral, Cold Call)"
          example: "Website Contact Form"
          nullable: true
        image:
          type: string
          format: binary
          description: "Lead avatar image (JPG, PNG, WEBP)"
          nullable: true

    LeadUpdateRequest:
      type: object
      description: "Update lead information (all fields optional)"
      properties:
        fullName:
          type: string
        dateOfBirth:
          type: string
          format: date
        email:
          type: string
          format: email
        phoneNumber:
          type: string
          pattern: '^[0-9]{10}$'
        company:
          type: string
        rating:
          type: integer
          minimum: 1
          maximum: 5
        expectedRevenue:
          type: number
          format: double
          minimum: 0
        note:
          type: string
        image:
          type: string
          format: binary

    LeadResponse:
      type: object
      description: "Lead information with stage, assigned user, and activities"
      properties:
        id:
          type: string
          format: uuid
          example: "lead-uuid-456"
        fullName:
          type: string
          example: "Jane Smith"
        dateOfBirth:
          type: string
          format: date
          example: "1990-05-15"
          nullable: true
        email:
          type: string
          example: "jane.smith@company.com"
        phoneNumber:
          type: string
          example: "0987654321"
        company:
          type: string
          example: "ABC Corporation"
          nullable: true
        rating:
          type: integer
          example: 4
          nullable: true
        expectedRevenue:
          type: number
          format: double
          example: 5000000
          nullable: true
        note:
          type: string
          example: "Interested in bulk purchase"
          nullable: true
        avatarUrl:
          type: string
          example: "https://res.cloudinary.com/demo/image/upload/lead-avatar.jpg"
          nullable: true
        source:
          type: string
          example: "Website"
          nullable: true
        stage:
          $ref: '#/components/schemas/StageResponse'
        assignTo:
          type: object
          description: "Assigned user basic info"
          nullable: true
          properties:
            id:
              type: string
              format: uuid
            firstName:
              type: string
            lastName:
              type: string
            email:
              type: string
        activities:
          type: array
          description: "Lead activities and interactions"
          items:
            $ref: '#/components/schemas/ActivityResponse'
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T10:00:00"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-15T14:30:00"

    StagesWithLeadsResponse:
      type: object
      description: "Pipeline stage with all its leads (Kanban view)"
      properties:
        id:
          type: string
          format: uuid
          description: "Stage ID"
        name:
          type: string
          description: "Stage name"
        color:
          type: string
          description: "Stage color (hex code)"
          example: "#4CAF50"
        leads:
          type: array
          description: "All leads in this stage"
          items:
            type: object
            description: "Simplified lead information for Kanban view"
            properties:
              id:
                type: string
                format: uuid
              fullName:
                type: string
              rating:
                type: integer
                nullable: true
              phoneNumber:
                type: string
              email:
                type: string
              source:
                type: string
                nullable: true
              avatarUrl:
                type: string
                nullable: true
              createdAt:
                type: string
                format: date-time
              updatedAt:
                type: string
                format: date-time
              responsibleBy:
                type: object
                nullable: true
                properties:
                  id:
                    type: string
                  firstName:
                    type: string
                  lastName:
                    type: string
                  email:
                    type: string

    # ==================== ACTIVITY SCHEMAS ====================
    
    ActivityCreationRequest:
      type: object
      required:
        - type
      description: "Create a new activity for a lead"
      properties:
        type:
          type: string
          description: "Activity type"
          example: "Call"
        content:
          type: string
          description: "Activity content/description"
          example: "Follow-up call to discuss product pricing"
          nullable: true
        validUntil:
          type: string
          format: date
          description: "Activity valid until date (default: 7 days from now)"
          example: "2024-01-27"
          nullable: true

    ActivityResponse:
      type: object
      description: "Activity information"
      properties:
        id:
          type: string
          format: uuid
          example: "activity-uuid-789"
        type:
          type: string
          example: "Call"
        content:
          type: string
          description: "Activity content/description"
          example: "Follow-up call completed"
          nullable: true
        createdAt:
          type: string
          format: date-time
          example: "2024-01-15T10:00:00"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-15T10:30:00"
        validUntil:
          type: string
          format: date
          description: "Activity valid until date"
          example: "2024-01-22"
        status:
          type: string
          description: "Activity status"
          example: "Completed"
        completed:
          type: boolean
          description: "Whether activity is completed"
          example: true

    # ==================== QUOTATION SCHEMAS ====================
    
    QuotationCreationRequest:
      type: object
      required:
        - leadId
        - title
        - items
      description: "Create a quotation for a lead"
      properties:
        leadId:
          type: string
          format: uuid
          description: "Lead identifier"
          example: "lead-uuid-456"
        title:
          type: string
          description: "Quotation title"
          example: "Product Quotation Q1-2024"
        content:
          type: string
          description: "Quotation content/notes"
          example: "As per our discussion, please find the quotation for your requirements."
          nullable: true
        validUntil:
          type: string
          format: date
          description: "Quotation validity date (defaults to +7 days)"
          example: "2024-01-31"
        items:
          type: array
          description: "Quotation line items"
          items:
            $ref: '#/components/schemas/QuotationItemRequest'
          minItems: 1

    QuotationItemRequest:
      type: object
      required:
        - productId
        - quantity
      description: "Individual item in quotation"
      properties:
        productId:
          type: string
          format: uuid
          description: "Product identifier"
          example: "product-uuid-123"
        quantity:
          type: integer
          description: "Quantity"
          example: 50
          minimum: 1
        unitPrice:
          type: number
          format: double
          description: "Override unit price (uses product price if not provided)"
          example: 58000
          minimum: 0
          nullable: true

    QuotationResponse:
      type: object
      description: "Quotation details with items and totals"
      properties:
        id:
          type: string
          format: uuid
          example: "quotation-uuid-abc"
        lead:
          type: object
          description: "Lead basic info"
          properties:
            id:
              type: string
              format: uuid
            fullName:
              type: string
            email:
              type: string
        title:
          type: string
          example: "Product Quotation Q1-2024"
        content:
          type: string
          example: "As discussed..."
          nullable: true
        validUntil:
          type: string
          format: date
          example: "2024-01-31"
        status:
          type: string
          description: "Quotation status"
          example: "Pending"
          enum: [ Pending, Sent, Accepted, Rejected, Converted ]
        untaxedAmount:
          type: number
          format: double
          description: "Subtotal before tax"
          example: 2900000
        finalAmount:
          type: number
          format: double
          description: "Total amount including tax"
          example: 3190000
        fileUrl:
          type: string
          description: "Generated PDF URL"
          example: "https://res.cloudinary.com/demo/quotation.pdf"
          nullable: true
        items:
          type: array
          description: "Quotation items"
          items:
            type: object
            properties:
              productId:
                type: string
                format: uuid
              productName:
                type: string
              quantity:
                type: integer
              unitPrice:
                type: number
                format: double
              subtotal:
                type: number
                format: double
        createdBy:
          type: object
          description: "User who created quotation"
          properties:
            id:
              type: string
              format: uuid
            firstName:
              type: string
            lastName:
              type: string
            email:
              type: string
        createdAt:
          type: string
          format: date-time
          example: "2024-01-15T10:00:00"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-15T10:00:00"

    # ==================== ORDER SCHEMAS ====================
    
    OrderCreationFromQuotationRequest:
      type: object
      required:
        - buyerName
        - shippingAddress
      description: "Convert quotation to order"
      properties:
        buyerName:
          type: string
          description: "Customer/buyer name"
          example: "Jane Smith"
        shippingAddress:
          type: string
          description: "Shipping address"
          example: "456 Business Avenue, City, District"

    OrderResponse:
      type: object
      description: "Order details with items"
      properties:
        id:
          type: string
          format: uuid
          example: "order-uuid-xyz"
        orderCode:
          type: string
          description: "Unique order code"
          example: "ORD-20240115-001"
        buyerName:
          type: string
          example: "Jane Smith"
        shippingAddress:
          type: string
          example: "456 Business Avenue"
        status:
          type: string
          description: "Order status"
          example: "Processing"
          enum: [ Pending, Processing, Shipped, Delivered, Cancelled ]
        totalAmount:
          type: number
          format: double
          description: "Total order amount"
          example: 3190000
        items:
          type: array
          description: "Order items"
          items:
            type: object
            properties:
              productId:
                type: string
                format: uuid
              productName:
                type: string
              quantity:
                type: integer
              unitPrice:
                type: number
                format: double
              subtotal:
                type: number
                format: double
        createdBy:
          type: object
          description: "User who created order"
          properties:
            id:
              type: string
              format: uuid
            firstName:
              type: string
            lastName:
              type: string
            email:
              type: string

    # ==================== CUSTOMER SCHEMAS ====================
    
    CustomerResponse:
      type: object
      description: "Converted customer (lead with orders)"
      properties:
        id:
          type: string
          format: uuid
          example: "customer-uuid-def"
        fullName:
          type: string
          example: "Jane Smith"
        email:
          type: string
          example: "jane.smith@company.com"
        phoneNumber:
          type: string
          example: "0987654321"
        company:
          type: string
          example: "ABC Corporation"
          nullable: true
        totalOrders:
          type: integer
          description: "Total number of orders"
          example: 5
        totalRevenue:
          type: number
          format: double
          description: "Total revenue from this customer"
          example: 15000000

security:
  - bearerAuth: [ ]

tags:
  - name: Authentication
    description: "User authentication and token management"
  - name: Users
    description: "User management and profiles"
  - name: Products
    description: "Product catalog management, search, and CSV import"
  - name: Stages
    description: "Sales pipeline stage management"
  - name: Leads
    description: "Lead management, activities, and pipeline progression"
  - name: Quotations
    description: "Create and manage quotations, send emails"
  - name: Orders
    description: "Order management and tracking"
  - name: Customers
    description: "View converted customers and their history"

paths:

  # ==================== AUTHENTICATION ENDPOINTS ====================
  
  /api/v1/authentication/login:
    post:
      tags:
        - Authentication
      summary: "User login"
      description: |
        Authenticate user with username and password.
        Returns JWT access token and refresh token for subsequent API calls.
      security: [ ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
            examples:
              ValidLogin:
                summary: "Valid login credentials"
                value:
                  username: "johndoe"
                  password: "password123"
      responses:
        '200':
          description: "Login successful"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/LoginResponse'
              examples:
                SuccessfulLogin:
                  summary: "Successful login"
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      accessToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJqb2huZG9lIiwiaWF0IjoxNjMzMDI0ODAwfQ.abc123"
                      refreshToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJqb2huZG9lIiwiaWF0IjoxNjMzMDI0ODAwfQ.def456"
                      fullName: "John Doe"
                      avatarUrl: "https://res.cloudinary.com/demo/image/upload/avatar.jpg"
        '401':
          description: "Invalid credentials"
          content:
            application/json:
              examples:
                InvalidCredentials:
                  summary: "Wrong username or password"
                  value:
                    code: 401
                    message: "Process Failed"
                    error:
                      code: 1005
                      message: "Unauthenticated"
        '400':
          description: "Validation error"
          content:
            application/json:
              examples:
                MissingFields:
                  summary: "Missing required fields"
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      - code: 2001
                        errorField: "username"
                        message: "Please fill in username"
                      - code: 2002
                        errorField: "password"
                        message: "Please fill in password"

  /api/v1/authentication/logout:
    post:
      tags:
        - Authentication
      summary: "User logout"
      description: |
        Logout current user and invalidate access token.
        Token will be added to blacklist and cannot be used for future requests.
      responses:
        '200':
          description: "Logout successful"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MyApiResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Logout successful"
        '401':
          description: "Unauthenticated - invalid or missing token"
          content:
            application/json:
              examples:
                Unauthenticated:
                  value:
                    code: 401
                    message: "Process Failed"
                    error:
                      code: 1005
                      message: "Unauthenticated"

  /api/v1/authentication/registration:
    post:
      tags:
        - Authentication
      summary: "Register new user"
      description: |
        Create a new user account with required information.
        Username, email, and phone number must be unique across all users.
      security: [ ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserCreationRequest'
            examples:
              ValidRegistration:
                summary: "Valid registration request"
                value:
                  username: "newuser123"
                  password: "SecurePass123!"
                  firstName: "Alice"
                  lastName: "Johnson"
                  email: "alice.johnson@example.com"
                  phoneNumber: "0912345678"
                  address: "789 Oak Street, City"
      responses:
        '201':
          description: "User created successfully"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserResponse'
              examples:
                Success:
                  value:
                    code: 201
                    message: "Process succeed"
                    data:
                      id: "user-uuid-new"
                      username: "newuser123"
                      firstName: "Alice"
                      lastName: "Johnson"
                      email: "alice.johnson@example.com"
                      phoneNumber: "0912345678"
                      address: "789 Oak Street, City"
                      avatarUrl: null
                      createdAt: "2024-01-16T10:00:00"
                      updatedAt: "2024-01-16T10:00:00"
        '400':
          description: "Validation error or duplicate data"
          content:
            application/json:
              examples:
                UsernameExists:
                  summary: "Username already exists"
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1001
                      message: "Username exsited, please fill in another username"
                EmailExists:
                  summary: "Email already registered"
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1003
                      message: "Email exsited, this email has been register"
                PhoneExists:
                  summary: "Phone number already registered"
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1004
                      message: "Phone number exsited, this phone has been register"
                ValidationErrors:
                  summary: "Invalid input format"
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      - code: 2003
                        errorField: "username"
                        message: "Username must be 8-100 characters"
                      - code: 2004
                        errorField: "password"
                        message: "Password must be at least 8 characters"
                      - code: 2005
                        errorField: "email"
                        message: "Invalid email format"
                      - code: 2006
                        errorField: "phoneNumber"
                        message: "Phone number must be 10 digits"

  /api/v1/authentication/refresh:
    post:
      tags:
        - Authentication
      summary: "Refresh access token"
      description: |
        Generate new access and refresh tokens using a valid refresh token.
        Use this when access token expires to maintain user session.
      security: [ ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshRequest'
            examples:
              ValidRefresh:
                value:
                  refreshToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        '200':
          description: "Tokens refreshed successfully"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/RefreshResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      accessToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.new-access-token"
        '401':
          description: "Invalid refresh token"
          content:
            application/json:
              examples:
                InvalidToken:
                  value:
                    code: 401
                    message: "Process Failed"
                    error:
                      code: 1110
                      message: "Invalid refresh token"

  # ==================== USERS ENDPOINTS ====================

  /api/v1/users:
    get:
      tags:
        - Users
      summary: "Get all users"
      description: "Retrieve paginated list of all users with optional sorting"
      parameters:
        - name: pageNo
          in: query
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
          description: "Page number (1-indexed)"
        - name: pageSize
          in: query
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
          description: "Number of items per page"
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
            default: "id"
            enum: [ id, username, email, createdAt ]
          description: "Field to sort by"
        - name: sortOrder
          in: query
          required: false
          schema:
            type: string
            default: "asc"
            enum: [ asc, desc ]
          description: "Sort direction"
      responses:
        '200':
          description: "Users retrieved successfully"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/UserResponse'
                      pagination:
                        $ref: '#/components/schemas/PageInfo'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      - id: "user-uuid-1"
                        username: "admin"
                        firstName: "Admin"
                        lastName: "User"
                        email: "admin@example.com"
                        phoneNumber: "0123456789"
                        address: "123 Main St"
                        avatarUrl: "https://res.cloudinary.com/demo/avatar1.jpg"
                        createdAt: "2024-01-01T10:00:00"
                        updatedAt: "2024-01-01T10:00:00"
                      - id: "user-uuid-2"
                        username: "sales1"
                        firstName: "Jane"
                        lastName: "Smith"
                        email: "jane@example.com"
                        phoneNumber: "0987654321"
                        address: "456 Oak Ave"
                        avatarUrl: null
                        createdAt: "2024-01-02T11:00:00"
                        updatedAt: "2024-01-02T11:00:00"
                    pagination:
                      hasPre: false
                      hasNext: true
                      pageNumber: 1
                      totalPages: 5

    put:
      tags:
        - Users
      summary: "Update self information"
      description: "Update current user's profile information"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserUpdateRequest'
            examples:
              UpdateProfile:
                value:
                  firstName: "John"
                  lastName: "Updated"
                  email: "john.new@example.com"
                  phoneNumber: "0999888777"
                  address: "New Address 123"
      responses:
        '200':
          description: "Profile updated successfully"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      id: "user-uuid-123"
                      username: "johndoe"
                      firstName: "John"
                      lastName: "Updated"
                      email: "john.new@example.com"
                      phoneNumber: "0999888777"
                      address: "New Address 123"
                      avatarUrl: "https://res.cloudinary.com/demo/avatar.jpg"
                      createdAt: "2024-01-01T10:00:00"
                      updatedAt: "2024-01-16T15:30:00"
        '400':
          description: "Validation error or duplicate email/phone"
          content:
            application/json:
              examples:
                EmailExists:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1003
                      message: "Email exsited, this email has been register"

  /api/v1/users/search:
    get:
      tags:
        - Users
      summary: "Search users"
      description: "Search users by username, email, first name, or last name"
      parameters:
        - name: query
          in: query
          required: true
          schema:
            type: string
          description: "Search query string"
          example: "john"
        - name: pageNo
          in: query
          schema:
            type: integer
            default: 1
        - name: pageSize
          in: query
          schema:
            type: integer
            default: 10
      responses:
        '200':
          description: "Search successful"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/UserResponse'
                      pagination:
                        $ref: '#/components/schemas/PageInfo'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      - id: "user-uuid-1"
                        username: "johndoe"
                        firstName: "John"
                        lastName: "Doe"
                        email: "john@example.com"
                        phoneNumber: "0123456789"
                        avatarUrl: null
                        createdAt: "2024-01-01T10:00:00"
                        updatedAt: "2024-01-01T10:00:00"
                    pagination:
                      hasPre: false
                      hasNext: false
                      pageNumber: 1
                      totalPages: 1
        '404':
          description: "No results found"
          content:
            application/json:
              examples:
                NoResults:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1006
                      message: "No results"

  /api/v1/users/info:
    get:
      tags:
        - Users
      summary: "Get self information"
      description: "Get current authenticated user's profile"
      responses:
        '200':
          description: "User info retrieved"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      id: "user-uuid-current"
                      username: "currentuser"
                      firstName: "Current"
                      lastName: "User"
                      email: "current@example.com"
                      phoneNumber: "0123456789"
                      address: "123 My Street"
                      avatarUrl: "https://res.cloudinary.com/demo/my-avatar.jpg"
                      createdAt: "2024-01-01T10:00:00"
                      updatedAt: "2024-01-10T12:00:00"

  /api/v1/users/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: "User ID"
    
    get:
      tags:
        - Users
      summary: "Get user by ID"
      description: "Retrieve specific user's profile by ID"
      responses:
        '200':
          description: "User found"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      id: "user-uuid-123"
                      username: "targetuser"
                      firstName: "Target"
                      lastName: "User"
                      email: "target@example.com"
                      phoneNumber: "0987654321"
                      address: "789 User Ave"
                      avatarUrl: null
                      createdAt: "2024-01-05T10:00:00"
                      updatedAt: "2024-01-05T10:00:00"
        '404':
          description: "User not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1002
                      message: "User not found"
    
    delete:
      tags:
        - Users
      summary: "Delete user"
      description: "Soft delete user (sets deleted flag to true)"
      responses:
        '200':
          description: "User deleted successfully"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MyApiResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "DELETED USER"
        '404':
          description: "User not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1002
                      message: "User not found"

  /api/v1/users/avatar:
    post:
      tags:
        - Users
      summary: "Upload user avatar"
      description: |
        Upload avatar image for current user.
        Supported formats: JPG, PNG, WEBP (max 1MB)
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - image
              properties:
                image:
                  type: string
                  format: binary
                  description: "Avatar image file"
      responses:
        '200':
          description: "Avatar uploaded successfully"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ImageResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      imageUrl: "https://res.cloudinary.com/demo/image/upload/v1234567890/avatar-new.jpg"
        '415':
          description: "Unsupported file type"
          content:
            application/json:
              examples:
                WrongFileType:
                  value:
                    code: 415
                    message: "Process Failed"
                    error:
                      code: 1100
                      message: "File type is not supported"
        '400':
          description: "File size exceeded or empty file"
          content:
            application/json:
              examples:
                FileTooLarge:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1101
                      message: "File size limit is 1MB"
                EmptyFile:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1102
                      message: "Empty file"


  # ====================PRODUCTS ENDPOINTS ====================

  /api/v1/products:
    post:
      tags:
        - Products
      summary: "Create new product"
      description: |
        Create a new product with required information.
        Supports optional image upload via multipart/form-data.
        SKU must be unique across all products.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ProductCreationRequest'
      responses:
        '201':
          description: "Product created successfully"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 201
                    message: "Process succeed"
                    data:
                      productId: "prod-uuid-123"
                      sku: "PRD-001"
                      productName: "Vitamin C 500mg"
                      description: "Premium vitamin C supplement for immune support"
                      productSubtitle: "Boost your immunity naturally"
                      productBrand: "Bidiphar"
                      productCategory: "Supplement"
                      quantity: 100
                      status: "Active"
                      purchaseUnitPrice: 59000
                      discount: 5
                      discountType: "PERCENT"
                      tag: "immune,health,vitamin"
                      imageUrl: "https://res.cloudinary.com/demo/product.jpg"
        '400':
          description: "Validation error, duplicate SKU, or file errors"
          content:
            application/json:
              examples:
                DuplicateSKU:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1008
                      message: "Product sku already exists"
                FileTooLarge:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1101
                      message: "File size limit is 1MB"
                EmptyFile:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1102
                      message: "Empty file"
        '415':
          description: "Unsupported file type"
          content:
            application/json:
              examples:
                UnsupportedFileType:
                  value:
                    code: 415
                    message: "Process Failed"
                    error:
                      code: 1100
                      message: "File type is not supported"

    get:
      tags:
        - Products
      summary: "Get all products"
      description: "Retrieve paginated list of products with optional filters"
      parameters:
        - name: pageNo
          in: query
          schema: { type: integer, default: 1 }
        - name: pageSize
          in: query
          schema: { type: integer, default: 10 }
        - name: sortBy
          in: query
          schema: { type: string, default: "sku" }
        - name: sortOrder
          in: query
          schema: { type: string, enum: [ asc, desc ], default: asc }
        - name: category
          in: query
          schema: { type: string }
        - name: status
          in: query
          schema: { type: string }
        - name: minPrice
          in: query
          schema: { type: number, format: double }
        - name: maxPrice
          in: query
          schema: { type: number, format: double }
      responses:
        '200':
          description: "Products retrieved successfully"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      - productId: "prod-1"
                        sku: "SP-001"
                        productName: "Vitamin C 500mg"
                        description: "Premium vitamin C supplement"
                        productSubtitle: "Boost immunity"
                        productBrand: "Bidiphar"
                        productCategory: "Supplement"
                        quantity: 100
                        status: "Active"
                        purchaseUnitPrice: 59000
                        discount: 5
                        discountType: "PERCENT"
                        tag: "immune,health,vitamin"
                        imageUrl: "https://res.cloudinary.com/demo/vitamin-c.jpg"
                      - productId: "prod-2"
                        sku: "SP-002"
                        productName: "Calcium 600+D3"
                        description: "Calcium with vitamin D3 for bone health"
                        productBrand: "Bidiphar"
                        productCategory: "Supplement"
                        quantity: 50
                        status: "Active"
                        purchaseUnitPrice: 72000
                        discount: 10
                        discountType: "PERCENT"
                        tag: "bone,health,calcium"
                        imageUrl: null
                    pagination:
                      hasPre: false
                      hasNext: true
                      pageNumber: 1
                      totalPages: 5

  /api/v1/products/search:
    get:
      tags:
        - Products
      summary: "Search products"
      description: "Search by name, SKU, or tags"
      parameters:
        - name: query
          in: query
          required: true
          schema: { type: string }
        - name: pageNo
          in: query
          schema: { type: integer, default: 1 }
        - name: pageSize
          in: query
          schema: { type: integer, default: 10 }
      responses:
        '200':
          description: "Search successful"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/ProductResponse'
                      pagination:
                        $ref: '#/components/schemas/PageInfo'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      - productId: "prod-uuid-1"
                        sku: "SP-001"
                        productName: "Vitamin C 500mg"
                        description: "Premium vitamin C supplement"
                        productSubtitle: "Boost immunity"
                        productBrand: "Bidiphar"
                        productCategory: "Supplement"
                        quantity: 100
                        status: "Active"
                        purchaseUnitPrice: 59000
                        discount: 5
                        discountType: "PERCENT"
                        tag: "immune,health,vitamin"
                        imageUrl: "https://res.cloudinary.com/demo/vitamin-c.jpg"
                    pagination:
                      hasPre: false
                      hasNext: false
                      pageNumber: 1
                      totalPages: 1
        '404':
          description: "No results found"
          content:
            application/json:
              examples:
                NoResults:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1006
                      message: "No results"

  /api/v1/products/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    
    get:
      tags:
        - Products
      summary: "Get product by ID"
      responses:
        '200':
          description: "Product found"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ProductResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      productId: "prod-uuid-123"
                      sku: "SP-1762772322687"
                      productName: "Macbook Pro M3"
                      description: "Latest Apple Macbook Pro with M3 chip"
                      productSubtitle: "Professional laptop for creators"
                      productBrand: "Apple"
                      productCategory: "MacBook"
                      quantity: 25
                      status: "Active"
                      purchaseUnitPrice: 50000000
                      discount: 5
                      discountType: "PERCENT"
                      tag: "laptop,mac,professional"
                      imageUrl: "https://res.cloudinary.com/demo/macbook.jpg"
        '404':
          description: "Product not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1007
                      message: "Product not found"
    
    patch:
      tags:
        - Products
      summary: "Update product"
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ProductUpdateRequest'
      responses:
        '200':
          description: "Product updated"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ProductResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      productId: "prod-uuid-123"
                      sku: "PRD-001"
                      productName: "Vitamin C 1000mg"
                      description: "High-strength vitamin C supplement"
                      productSubtitle: "Double strength formula"
                      productBrand: "Bidiphar"
                      productCategory: "Supplement"
                      quantity: 80
                      status: "Active"
                      purchaseUnitPrice: 89000
                      discount: 10
                      discountType: "PERCENT"
                      tag: "immune,health,vitamin"
                      imageUrl: "https://res.cloudinary.com/demo/vitamin-c-1000.jpg"
        '404':
          description: "Product not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1007
                      message: "Product not found"
    
    delete:
      tags:
        - Products
      summary: "Delete product"
      responses:
        '200':
          description: "Product deleted"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Product deleted successfully"
        '404':
          description: "Product not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1007
                      message: "Product not found"

  /api/v1/products/csv:
    post:
      tags:
        - Products
      summary: "Import products from CSV"
      description: "Bulk import products (max 100 rows)"
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [ matching, file ]
              properties:
                matching:
                  $ref: '#/components/schemas/MatchingRequest'
                file:
                  type: string
                  format: binary
      responses:
        '200':
          description: "Import completed"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      - productId: "prod-uuid-1"
                        sku: "SP-001"
                        productName: "Vitamin C 500mg"
                        description: "Imported vitamin C supplement"
                        productSubtitle: null
                        productBrand: "Bidiphar"
                        productCategory: "Supplement"
                        quantity: 100
                        status: "Active"
                        purchaseUnitPrice: 59000
                        discount: 0
                        discountType: "NONE"
                        tag: "health"
                        imageUrl: null
                      - productId: "prod-uuid-2"
                        sku: "SP-002"
                        productName: "Calcium 600+D3"
                        description: "Imported calcium supplement"
                        productSubtitle: null
                        productBrand: "Bidiphar"
                        productCategory: "Supplement"
                        quantity: 50
                        status: "Active"
                        purchaseUnitPrice: 72000
                        discount: 0
                        discountType: "NONE"
                        tag: "health"
                        imageUrl: null
                    error:
                      - productId: "prod-uuid-3"
                        sku: "SP-007"
                        productName: "Invalid Product"
                        description: null
                        productSubtitle: null
                        productBrand: null
                        productCategory: null
                        quantity: 0
                        status: null
                        purchaseUnitPrice: null
                        discount: 0
                        discountType: "NONE"
                        tag: null
                        imageUrl: null
        '415':
          description: "Unsupported file type"
          content:
            application/json:
              examples:
                UnsupportedFileType:
                  value:
                    code: 415
                    message: "Process Failed"
                    error:
                      code: 1100
                      message: "File type is not supported"
        '400':
          description: "File errors or invalid data"
          content:
            application/json:
              examples:
                FileTooLarge:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1101
                      message: "File size limit is 1MB"
                TooManyRows:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1103
                      message: "CSV file contains more than 100 rows"
                InvalidMapping:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1009
                      message: "Mapping not suitable"

  # ==================== STAGES ENDPOINTS ====================

  /api/v1/stages:
    post:
      tags:
        - Stages
      summary: "Create stage"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StageCreationRequest'
      responses:
        '201':
          description: "Stage created"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/StageResponse'
              examples:
                Success:
                  value:
                    code: 201
                    message: "Process succeed"
                    data:
                      id: "stage-uuid-new"
                      name: "Qualified"
                      order: 2
                      isDefault: false
        '400':
          description: "Stage already exists"
          content:
            application/json:
              examples:
                AlreadyExists:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1010
                      message: "Stage name already exists"

  /api/v1/stages/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    
    patch:
      tags:
        - Stages
      summary: "Update stage"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StageUpdateRequest'
      responses:
        '200':
          description: "Stage updated"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/StageResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      id: "stage-uuid-123"
                      name: "Highly Qualified"
                      order: 3
                      isDefault: false
        '404':
          description: "Stage not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1011
                      message: "Stage not found"

    delete:
      tags:
        - Stages
      summary: "Delete stage"
      responses:
        '200':
          description: "Stage deleted"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Stage deleted successfully"
        '400':
          description: "Cannot delete - stage in use or default stage"
          content:
            application/json:
              examples:
                StageInUse:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1012
                      message: "Cannot delete stage with existing leads"

  /api/v1/stages/{id}/leads:
    post:
      tags:
        - Stages
      summary: "Create lead in stage"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/LeadCreationRequest'
      responses:
        '201':
          description: "Lead created"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/LeadResponse'
              examples:
                Success:
                  value:
                    code: 201
                    message: "Process succeed"
                    data:
                      id: "lead-uuid-new"
                      fullName: "Jane Smith"
                      dateOfBirth: "1990-05-15"
                      email: "jane.smith@company.com"
                      phoneNumber: "0987654321"
                      company: "ABC Corporation"
                      rating: 4
                      expectedRevenue: 5000000
                      note: "Interested in bulk purchase"
                      avatarUrl: null
                      source: "Manual Entry"
                      stage:
                        id: "stage-uuid-123"
                        name: "New"
                        order: 1
                        color: "#4CAF50"
                        isDefault: true
                      assignTo:
                        id: "user-uuid-1"
                        firstName: "John"
                        lastName: "Doe"
                        email: "john.doe@company.com"
                      activities: [ ]
                      createdAt: "2024-01-16T10:00:00"
                      updatedAt: "2024-01-16T10:00:00"
        '415':
          description: "Unsupported file type"
          content:
            application/json:
              examples:
                UnsupportedFileType:
                  value:
                    code: 415
                    message: "Process Failed"
                    error:
                      code: 1100
                      message: "File type is not supported"
        '400':
          description: "Validation or file errors"
          content:
            application/json:
              examples:
                FileTooLarge:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1101
                      message: "File size limit is 1MB"
                ValidationError:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      - code: 2005
                        errorField: "email"
                        message: "Invalid email format"
                      - code: 2006
                        errorField: "phoneNumber"
                        message: "Phone number must be 10 digits"

  # ==================== LEADS ENDPOINTS ====================

  /api/v1/leads:
    get:
      tags:
        - Leads
      summary: "Get stages with leads (Kanban view)"
      responses:
        '200':
          description: "Stages with leads retrieved"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/StagesWithLeadsResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      - id: "stage-1"
                        name: "New"
                        color: "#4CAF50"
                        leads:
                          - id: "lead-1"
                            fullName: "Jane Smith"
                            rating: 3
                            phoneNumber: "0987654321"
                            email: "jane@example.com"
                            source: "Website"
                            avatarUrl: null
                            createdAt: "2024-01-15T10:00:00"
                            updatedAt: "2024-01-15T10:00:00"
                            responsibleBy:
                              id: "user-uuid-1"
                              firstName: "John"
                              lastName: "Doe"
                              email: "john.doe@company.com"
                      - id: "stage-2"
                        name: "Qualified"
                        color: "#2196F3"
                        leads:
                          - id: "lead-2"
                            fullName: "John Doe"
                            rating: 4
                            phoneNumber: "0123456789"
                            email: "john@example.com"
                            source: "Referral"
                            avatarUrl: null
                            createdAt: "2024-01-16T11:00:00"
                            updatedAt: "2024-01-16T11:00:00"
                            responsibleBy:
                              id: "user-2"
                              firstName: "Jane"
                              lastName: "Smith"
                              email: "jane.smith@company.com"

  /api/v1/leads/search:
    get:
      tags:
        - Leads
      parameters:
        - name: query
          in: query
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Search successful"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/StagesWithLeadsResponse'
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      - id: "stage-1"
                        name: "New"
                        color: "#4CAF50"
                        leads:
                          - id: "lead-1"
                            fullName: "Jane Smith"
                            rating: 3
                            phoneNumber: "0987654321"
                            email: "jane@company.com"
                            source: "Website"
                            avatarUrl: null
                            createdAt: "2024-01-15T10:00:00"
                            updatedAt: "2024-01-15T10:00:00"
                            responsibleBy:
                              id: "user-1"
                              firstName: "John"
                              lastName: "Doe"
                              email: "john.doe@company.com"
        '404':
          description: "No results"
          content:
            application/json:
              examples:
                NoResults:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1006
                      message: "No results"

  /api/v1/leads/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    
    get:
      tags:
        - Leads
      summary: "Get lead details"
      responses:
        '200':
          description: "Lead found"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/LeadResponse'
        '404':
          description: "Lead not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1013
                      message: "Lead not found"
    
    patch:
      tags:
        - Leads
      summary: "Update lead"
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/LeadUpdateRequest'
      responses:
        '200':
          description: "Lead updated"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/LeadResponse'
        '404':
          description: "Lead not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1013
                      message: "Lead not found"
    
    delete:
      tags:
        - Leads
      summary: "Delete lead"
      responses:
        '200':
          description: "Lead deleted"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Lead deleted successfully"
        '404':
          description: "Lead not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1013
                      message: "Lead not found"

  /api/v1/leads/{id}/stages:
    patch:
      tags:
        - Leads
      summary: "Update lead stage"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
        - name: stageId
          in: query
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Stage updated"

  /api/v1/leads/{id}/assign:
    patch:
      tags:
        - Leads
      summary: "Assign lead to user"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
        - name: userId
          in: query
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Lead assigned"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Lead assigned successfully"

  /api/v1/leads/{id}/activities:
    post:
      tags:
        - Leads
      summary: "Create activity"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ActivityCreationRequest'
      responses:
        '201':
          description: "Activity created"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ActivityResponse'
              examples:
                Success:
                  value:
                    code: 201
                    message: "Process succeed"
                    data:
                      id: "activity-uuid-new"
                      type: "Call"
                      description: "Follow-up call"
                      status: "Pending"

  /api/v1/leads/{leadId}/activities/{activityId}/complete:
    patch:
      tags:
        - Leads
      summary: "Mark activity as completed"
      parameters:
        - name: leadId
          in: path
          required: true
          schema: { type: string }
        - name: activityId
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Activity completed"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Activity marked as completed"

  /api/v1/leads/{leadId}/activities/{activityId}:
    delete:
      tags:
        - Leads
      summary: "Delete activity"
      parameters:
        - name: leadId
          in: path
          required: true
          schema: { type: string }
        - name: activityId
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Activity deleted"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Activity deleted successfully"

  /api/v1/leads/csv:
    post:
      tags:
        - Leads
      summary: "Import leads from CSV"
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                matching:
                  $ref: '#/components/schemas/MatchingRequest'
                file:
                  type: string
                  format: binary
      responses:
        '200':
          description: "Import completed"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Process succeed"
                    data:
                      - id: "lead-uuid-1"
                        fullName: "John Doe"
                        dateOfBirth: null
                        email: "john@example.com"
                        phoneNumber: "0123456789"
                        company: "Tech Corp"
                        rating: 3
                        expectedRevenue: 1000000
                        note: null
                        avatarUrl: null
                        source: "CSV Import"
                        stage:
                          id: "stage-uuid-new"
                          name: "New"
                          order: 1
                          isDefault: true
                        assignTo: null
                        activities: [ ]
                        createdAt: "2024-01-16T10:00:00"
                        updatedAt: "2024-01-16T10:00:00"
                    error:
                      - id: "lead-uuid-2"
                        fullName: "Invalid Lead"
                        dateOfBirth: null
                        email: "invalid-email"
                        phoneNumber: null
                        company: null
                        rating: null
                        expectedRevenue: null
                        note: null
                        avatarUrl: null
                        source: "CSV Import"
                        stage:
                          id: "stage-uuid-new"
                          name: "New"
                          order: 1
                          isDefault: true
                        assignTo: null
                        activities: [ ]
                        createdAt: null
                        updatedAt: null
        '415':
          description: "Unsupported file type"
          content:
            application/json:
              examples:
                UnsupportedFileType:
                  value:
                    code: 415
                    message: "Process Failed"
                    error:
                      code: 1100
                      message: "File type is not supported"
        '400':
          description: "File errors or invalid data"
          content:
            application/json:
              examples:
                FileTooLarge:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1101
                      message: "File size limit is 1MB"
                TooManyRows:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1103
                      message: "CSV file contains more than 100 rows"
                InvalidMapping:
                  value:
                    code: 400
                    message: "Process Failed"
                    error:
                      code: 1009
                      message: "Mapping not suitable"

  # ==================== QUOTATIONS ENDPOINTS ====================

  /api/v1/quotations:
    post:
      tags:
        - Quotations
      summary: "Create quotation"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QuotationCreationRequest'
      responses:
        '201':
          description: "Quotation created"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/QuotationResponse'
              examples:
                Success:
                  value:
                    code: 201
                    message: "Process succeed"
                    data:
                      id: "quotation-uuid-new"
                      title: "Product Quotation Q1-2024"
                      status: "Pending"
                      untaxedAmount: 2900000
                      finalAmount: 3190000

    get:
      tags:
        - Quotations
      summary: "Get all quotations"
      parameters:
        - name: pageNo
          in: query
          schema: { type: integer, default: 1 }
        - name: pageSize
          in: query
          schema: { type: integer, default: 10 }
        - name: sortBy
          in: query
          schema: { type: string, default: "id" }
        - name: sortOrder
          in: query
          schema: { type: string, default: "asc" }
      responses:
        '200':
          description: "Quotations retrieved"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/QuotationResponse'
                      pagination:
                        $ref: '#/components/schemas/PageInfo'

  /api/v1/quotations/{id}:
    get:
      tags:
        - Quotations
      summary: "Get quotation by ID"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Quotation found"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/QuotationResponse'
        '404':
          description: "Quotation not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1014
                      message: "Quotation not found"
    
    delete:
      tags:
        - Quotations
      summary: "Delete quotation"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Quotation deleted"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Quotation deleted successfully"

  /api/v1/quotations/{id}/mail:
    post:
      tags:
        - Quotations
      summary: "Send quotation email"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Email sent successfully"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Quotation email sent successfully"
        '500':
          description: "Mailing failed"
          content:
            application/json:
              examples:
                MailError:
                  value:
                    code: 500
                    message: "Process Failed"
                    error:
                      code: 9999
                      message: "Failed to send email"

  /api/v1/quotations/{id}/orders:
    post:
      tags:
        - Quotations
      summary: "Convert quotation to order"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderCreationFromQuotationRequest'
      responses:
        '201':
          description: "Order created from quotation"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/OrderResponse'
              examples:
                Success:
                  value:
                    code: 201
                    message: "Process succeed"
                    data:
                      id: "order-uuid-new"
                      orderCode: "ORD-20240115-001"
                      buyerName: "Jane Smith"
                      status: "Pending"
                      totalAmount: 3190000

  # ==================== ORDERS ENDPOINTS ====================

  /api/v1/orders:
    get:
      tags:
        - Orders
      summary: "Get all orders"
      parameters:
        - name: pageNo
          in: query
          schema: { type: integer, default: 1 }
        - name: pageSize
          in: query
          schema: { type: integer, default: 10 }
        - name: sortBy
          in: query
          schema: { type: string, default: "id" }
        - name: sortOrder
          in: query
          schema: { type: string, default: "asc" }
      responses:
        '200':
          description: "Orders retrieved"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/OrderResponse'
                      pagination:
                        $ref: '#/components/schemas/PageInfo'

  /api/v1/orders/{id}:
    get:
      tags:
        - Orders
      summary: "Get order details"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Order found"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/OrderResponse'
        '404':
          description: "Order not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1015
                      message: "Order not found"
    
    delete:
      tags:
        - Orders
      summary: "Delete order"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Order deleted"
          content:
            application/json:
              examples:
                Success:
                  value:
                    code: 200
                    message: "Order deleted successfully"

  # ==================== CUSTOMERS ENDPOINTS ====================

  /api/v1/customers:
    get:
      tags:
        - Customers
      summary: "Get all customers"
      parameters:
        - name: pageNo
          in: query
          schema: { type: integer, default: 1 }
        - name: pageSize
          in: query
          schema: { type: integer, default: 10 }
        - name: sortBy
          in: query
          schema: { type: string, default: "id" }
        - name: sortOrder
          in: query
          schema: { type: string, default: "asc" }
      responses:
        '200':
          description: "Customers retrieved"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/CustomerResponse'
                      pagination:
                        $ref: '#/components/schemas/PageInfo'

  /api/v1/customers/{id}:
    get:
      tags:
        - Customers
      summary: "Get customer details"
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: "Customer found"
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/MyApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/CustomerResponse'
        '404':
          description: "Customer not found"
          content:
            application/json:
              examples:
                NotFound:
                  value:
                    code: 404
                    message: "Process Failed"
                    error:
                      code: 1016
                      message: "Customer not found"
